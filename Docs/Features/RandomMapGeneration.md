# 随机地图生成功能说明

## 概述
本项目实现了强大的随机地图生成功能，基于Perlin噪声和Voronoi图算法，能够生成多样化的地形和地貌特征。

## 核心功能

### 1. 随机种子管理
- **SeedManager**: 管理地图生成种子，支持生成唯一标识符作为种子
- **多样化种子**: 支持时间戳+随机数组合或描述性词汇组合
- **种子历史**: 保存最近使用的种子，便于重现特定地图

### 2. 地图生成管理器
- **MapGenerationManager**: 统一管理地图生成流程
- **主题生成**: 支持多种地图主题（大陆型、岛屿型、群岛型等）
- **事件系统**: 提供地图生成完成和进度更新事件

### 3. 生成参数控制
- **单元数量**: 控制地图细节程度（100-2000）
- **水位线**: 控制海洋与陆地比例（0.0-1.0）
- **地形模板**: 使用预设模板生成特定地形类型

## 使用方法

### 代码中使用
```csharp
// 创建地图生成管理器
var generationManager = new MapGenerationManager();

// 生成随机地图
generationManager.GenerateNewMap(cellCount: 800, waterLevel: 0.35f);

// 生成特定主题地图
generationManager.GenerateThemedMap(MapTheme.Island, cellCount: 600);

// 重新生成当前地图
generationManager.RegenerateCurrentMap();
```

### UI控制
- **生成新地图按钮**: 生成全新的随机地图
- **重新生成按钮**: 使用相同参数但新种子重新生成
- **单元数量滑块**: 调整地图细节
- **水位线滑块**: 调整海洋陆地比例
- **主题选择器**: 选择不同的地形主题

## 技术特点

### 1. 算法组合
- **Perlin噪声**: 生成自然地形高度
- **Voronoi图**: 划分地理单元
- **Delaunay三角剖分**: 构建几何关系
- **河流系统**: 基于地形的水流模拟

### 2. 性能优化
- **分阶段生成**: 将生成过程分为多个阶段，便于调试和优化
- **内存管理**: 有效管理大量地理数据
- **渐进式渲染**: 优化地图显示性能

### 3. 可扩展性
- **模块化设计**: 各功能模块独立，易于扩展
- **事件驱动**: 便于与其他系统集成
- **参数化配置**: 易于调整生成参数

## 地图主题类型

- **Continental**: 大陆型地形，中央为陆地，四周环海
- **Island**: 孤立岛屿，四周环海
- **Archipelago**: 群岛型，多个大小不一的岛屿
- **Pangea**: 盘古大陆型，单一超大陆
- **ContinentAndIslands**: 大陆加周边岛屿
- **Mediterranean**: 地中海型，内陆海被陆地包围
- **Peninsula**: 半岛型，陆地向海洋延伸

## 集成到游戏
随机地图生成功能在Game.cs中已完全集成，玩家可以通过UI控件轻松生成各种类型的随机地图。